
let logo = '<svg x="0px" y="0px" viewBox="0 0 500 75.3" style="enable-background:new 0 0 500 75.3;" xml:space="preserve"><g id="XMLID_29_"><path id="XMLID_30_" d="M61.1,5.3H9.5V0h34.6C50.6,0,56.2,1.8,61.1,5.3z M69.7,15.6H9.5v-5.3h56.7C67.5,11.8,68.7,13.6,69.7,15.6z M69.2,59.3c-0.9,1.6-2.1,3.4-3.5,5.3H9.5v-5.3H69.2z M60.5,69.7c-4.6,3.5-9.9,5.2-15.8,5.2H9.5v-5.2H60.5z M38.9,25.4H19.6v-4.9h19.3V25.4z M38.9,35H19.6v-4.9h19.3V35z M38.9,44.7H19.6v-4.8h19.3V44.7z M38.9,54.2H19.6v-4.9h19.3V54.2z M73.3,25.4H50.1v-4.9h21.9C72.6,22.5,73,24.1,73.3,25.4z M74.6,35H50.1v-4.9h24.1C74.3,31.1,74.4,32.7,74.6,35z M74.5,39.9c-0.1,1.1-0.2,2.7-0.5,4.8H50.1v-4.8H74.5z M73,49.3c-0.4,1.6-1,3.3-1.6,4.9H50.1v-4.9H73z"/><path id="XMLID_43_" d="M105.3,34.5H75.5c0.1-1.2,0.2-2.8,0.5-4.7h29.3V34.5z M105.3,43.6H76c-0.3-2.1-0.4-3.7-0.4-4.9h29.8V43.6z M105.3,54.2H78.9c-0.8-1.7-1.5-3.7-2-5.9h28.4V54.2z M105.3,25H77.1c0.4-1.7,1-3.2,1.6-4.6h26.6V25z M139.3,15.6h-58c1.3-2.2,2.6-4,4-5.3h49.8C136.5,11.7,137.9,13.5,139.3,15.6z M140.4,59.3c-1.1,1.8-2.4,3.6-3.9,5.3H85.7c-1.8-2-3.1-3.7-4-5.3H140.4z M129,5.3H91.1C96.6,1.8,102.9,0,110,0C117,0,123.3,1.8,129,5.3z M130.4,69.7c-5.4,3.5-11.7,5.2-19.1,5.2c-7.4,0-13.9-1.7-19.3-5.2H130.4z M143.8,25h-27.3v-4.6h25.5C142.6,22.1,143.2,23.6,143.8,25z M145.6,34.5h-29.1v-4.7h28.4C145.2,31.3,145.4,32.9,145.6,34.5z M145.8,38.7c0,1.1-0.1,2.8-0.2,4.9h-29.1v-4.9H145.8z M144.7,48.3c-0.4,1.9-1,3.9-1.8,5.9h-26.4v-5.9H144.7z"/><path id="XMLID_56_" d="M170.6,5.3h-28.6V0h28.6V5.3z M173.9,15.6h-31.9v-5.3h29.2L173.9,15.6z M173.9,59.3l-2.5,5.3h-29.4v-5.3H173.9z M171,74.9h-29.1v-5.2H171V74.9z M200,54.2h-23.3l-0.2-0.4l-0.2,0.4H153l3.5-5.9h40L200,54.2z M199.1,20.5l-3,4.6h-39.4l-3-4.6H199.1z M193.6,43.6h-34.3l3-4.9h28.3L193.6,43.6z M193.1,29.8l-3.1,4.7H163l-3.1-4.7H193.1z M211,15.6h-31.9l2.8-5.3H211V15.6z M211,64.6h-29.4l-2.5-5.3H211V64.6z M211,74.9h-29.1v-5.2H211V74.9z M211,5.3h-28.6V0H211V5.3z"/><path id="XMLID_69_" d="M266.1,25h-21.5c-0.1-0.8-0.2-1.6-0.2-2.3v-0.6c0-0.4,0-1,0.1-1.6h21.6V25z M262.9,54.2h-18.2v-5.9h18.2V54.2z M298.3,59.3c-0.4,1.6-1,3.4-2,5.3h-51.7v-5.3H298.3z M292.7,69.7c-3.3,3.5-7.5,5.2-12.4,5.2h-35.6v-5.2H292.7z M296.7,15.6h-51.7c0.4-2,1.1-3.7,1.9-5.3h49.8V15.6z M293,34.5h-45.8c-0.8-1.6-1.4-3.2-1.8-4.7h39.1c1.1,0,2.6,0.6,4.6,1.7C290.7,32.5,292,33.5,293,34.5z M298.2,43.6h-40.3c-1,0-2.4-0.6-4.2-1.8c-1.6-1.1-2.8-2.1-3.6-3.1h46.1C296.9,40,297.6,41.6,298.2,43.6z M296.7,5.3h-46.5c3.2-3.5,7.3-5.3,12.4-5.3h34.1V5.3z M299.4,52.1c0,0.6,0,1.3-0.1,2.1h-21.7v-5.9h21.6c0.1,1.1,0.2,2.2,0.2,3.1V52.1z M296.7,25h-16v-4.6h16V25z"/><path id="XMLID_80_" d="M369,5.3h-70.7V0H369V5.3z M369,15.6h-70.7v-5.3H369V15.6z M315.9,25h-17.6v-4.6h17.6V25z M354,64.6h-40.7v-5.3H354V64.6z M354,74.9h-40.7v-5.2H354V74.9z M343.8,25h-20.4v-4.6h20.4V25z M343.8,34.5h-20.4v-4.7h20.4V34.5z M343.8,43.6h-20.4v-4.9h20.4V43.6z M343.8,54.2h-20.4v-5.9h20.4V54.2z M369,25h-17.6v-4.6H369V25z"/><path id="XMLID_91_" d="M397.1,34.5h-29.8c0.1-1.2,0.2-2.8,0.5-4.7h29.3V34.5z M397.1,43.6h-29.4c-0.3-2.1-0.4-3.7-0.4-4.9h29.8V43.6z M397.1,54.2h-26.4c-0.8-1.7-1.4-3.7-2-5.9h28.4V54.2z M397.1,25h-28.2c0.4-1.7,1-3.2,1.6-4.6h26.6V25z M431,15.6h-58c1.3-2.2,2.6-4,4-5.3h49.8C428.2,11.7,429.6,13.5,431,15.6z M432.1,59.3c-1.1,1.8-2.4,3.6-3.9,5.3h-50.7c-1.8-2-3.1-3.7-4-5.3H432.1z M420.7,5.3h-37.9c5.4-3.5,11.7-5.3,18.9-5.3C408.8,0,415.1,1.8,420.7,5.3z M422.1,69.7c-5.4,3.5-11.7,5.2-19.1,5.2c-7.4,0-13.9-1.7-19.3-5.2H422.1z M435.5,25h-27.3v-4.6h25.5C434.3,22.1,434.9,23.6,435.5,25z M437.3,34.5h-29.1v-4.7h28.4C436.9,31.3,437.2,32.9,437.3,34.5z M437.5,38.7c0,1.1-0.1,2.8-0.2,4.9h-29.1v-4.9H437.5z M436.4,48.3c-0.4,1.9-1,3.9-1.8,5.9h-26.4v-5.9H436.4z"/><path id="XMLID_104_" d="M491.5,5.3h-57.2V0H477C482.9,0,487.8,1.8,491.5,5.3z M497.4,15.6h-63.1v-5.3h61C496.2,11.6,496.9,13.4,497.4,15.6z M475.1,64.6h-40.7v-5.3h40.7V64.6z M475.1,74.9h-40.7v-5.2h40.7V74.9z M465.1,25h-20.4v-4.6h20.4V25z M497,29.8c-0.6,1.8-1.2,3.4-2,4.7h-50.3v-4.7H497z M491.7,38.7c-3.4,3.3-6.6,4.9-9.7,4.9h-37.3v-4.9H491.7z M465.1,54.2h-20.4v-5.9h20.4V54.2z M498.3,22.1c0,0.6-0.1,1.6-0.2,3h-21.4v-4.6h21.5l0.1,1.1V22.1z"/></g></svg>';

let history = [];
let resultDisplay = document.getElementById('resultDisplay');
let artDisplay = document.getElementById('artDisplay');
let historyBtn = document.getElementById('history');

document.getElementById('asciiArt').innerHTML=asciiArt[2];

document.getElementById('doxstopLogo').innerHTML = logo;

let input = document.getElementById('input');
let fakeInput = document.getElementById('fakeInput');
let searchBtn = document.getElementsByTagName('button')[0];
let randomSearchBtn = document.getElementsByTagName('button')[1];

document.body.focus();


fakeInput.addEventListener('click',()=>{
  fakeInput.style.visibility = 'hidden';
  input.style.visibility = 'visible';
  input.focus();
  input.value = ''});

input.addEventListener('blur',()=>{
  if(input.value) return
  fakeInput.style.visibility = 'visible';
  input.style.visibility = 'hidden';
  fakeInput.value = '_'});

input.addEventListener('keydown',(key)=>{
  if(key.key !== 'Enter' || !input.value) return;
  doxSearch(input.value);
})

searchBtn.addEventListener('click',()=>{if(input.value) doxSearch(input.value)});

randomSearchBtn.addEventListener('click',()=>randomDox());

function doxSearch(val){
  //Value checker failsafe
  if(!val) return;

  //Rid of extra whitespaces, split input, delclare vars, and clear input bar
  let temp = val.replace(/\s+/g, " ").toLowerCase().split(' ');

  //Push the search to history
  history.unshift(val.replace(/\s+/g, " "));
  
  let result = [];
  search = [];
  input.value = '';

  
  //Uppercase only first letter of word
  for (let name of temp){
    let n = name.charAt(0).toUpperCase() + name.substr(1);
    search.push(n);
  }

  //Search for matches
  for (let id in search){
    let find = search[id];
    for(let dox in doxxed){
      let given = doxxed[dox].GivenName;
      let sur = doxxed[dox].Surname;
      if(find === given || find === sur) result.push(doxxed[dox]);
    }
  }

  //Send results to result function
  searchResult(result);
}

function randomDox(){
  let search = doxxed[Math.floor(Math.random()*doxxed.length)];
  history.unshift(`${search.GivenName} ${search.Surname}`)
  searchResult([search]);
}

function searchResult(result){
  artDisplay.style.visibility = 'hidden';
  resultDisplay.innerHTML = '';

  let resultFound = ()=>{
    for(res in result){
      console.log(result[res].GivenName,result[res].Surname,result[res]);
      renderitem(result[res]);
    }
  }
  
  let noResult = ()=>{
    console.log('No Result');
    artDisplay.style.visibility = 'visible';
  }
  
  result[0] ? resultFound() : noResult();
}


function openAbout(){
  let aboutModal = document.createElement('script');
  aboutModal.id = 'modal';
  aboutModal.setAttribute('src','js/modal.js');
  document.body.appendChild(aboutModal);
}

document.getElementById('about').addEventListener('click',()=>openAbout());
// openAbout();

function renderitem(obj){
  // input = JSON.stringify(input);
  let item = document.createElement('div');
  item.setAttribute('class','resultItem');

  let itemFieldContainer = document.createElement('div');
  itemFieldContainer.setAttribute('class','resultItem-fieldContainer');
  
  let itemContainer = document.createElement('div');
  itemContainer.setAttribute('class','resultItem-Container');

  let itemImg = document.createElement('svg');
  itemImg.setAttribute('class','resultItem-svg');
  
  
  for(let prop in obj){
    let infoField = makeItemField(prop, obj[prop]);
    itemFieldContainer.appendChild(infoField);
  }

  let svgMale = '<svg iconCreditTo="https://www.flaticon.com/authors/icomoon" x="0px" y="0px" width="448" height="432" viewBox="0 0 448 432" xml:space="preserve"><g><path d="m 279.412,311.368 c -11.055,-1.759 -11.307,-32.157 -11.307,-32.157 0,0 32.484,-32.158 39.564,-75.401 19.045,0 30.809,-45.973 11.76,-62.148 C 320.227,124.635 343.91,8 224,8 104.089,8 127.775,124.635 128.568,141.662 c -19.047,16.175 -7.285,62.148 11.761,62.148 7.079,43.243 39.564,75.401 39.564,75.401 0,0 -0.252,30.398 -11.307,32.157 C 132.976,317.034 0,375.686 0,440 H 224 448 C 448,375.686 315.023,317.034 279.412,311.368 Z" id="path2" inkscape:connector-curvature="0"/></g></svg>';
  '<svg iconCreditTo="https://www.flaticon.com/authors/icomoon" x="0px" y="0px" width="448px" height="448px" viewBox="0 0 448 448" style="enable-background:new 0 0 448 448;" xml:space="preserve"><g> <path d="M279.412,311.368c-11.055-1.759-11.307-32.157-11.307-32.157s32.484-32.158,39.564-75.401 c19.045,0,30.809-45.973,11.76-62.148C320.227,124.635,343.91,8,224,8c-119.911,0-96.225,116.635-95.432,133.662 c-19.047,16.175-7.285,62.148,11.761,62.148c7.079,43.243,39.564,75.401,39.564,75.401s-0.252,30.398-11.307,32.157 C132.976,317.034,0,375.686,0,440h224h224C448,375.686,315.023,317.034,279.412,311.368z"/></g></svg>';
  let svgFemale = '<svg iconCreditTo="https://www.flaticon.com/authors/pixel-perfect" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve"><g><g><path d="M421.184,384.96l-81.728-20.437l-4.715-18.88c56.384-9.493,85.397-26.389,86.677-27.136c3.029-1.771,4.907-4.992,5.163-8.491c0.235-3.499-1.323-6.933-4.075-9.131C422.123,300.587,384,269.099,384,160c0-92.011-21.525-138.667-64-138.667h-6.293C298.389,6.528,286.891,0,256,0c-40.085,0-128,40.299-128,160c0,109.099-38.123,140.587-38.4,140.8c-2.837,2.133-4.437,5.525-4.267,9.067c0.192,3.563,2.112,6.763,5.163,8.597c1.28,0.768,30.016,17.749,86.741,27.221l-4.715,18.837L90.795,384.96C37.333,398.336,0,446.165,0,501.333C0,507.221,4.779,512,10.667,512h490.667c5.888,0,10.667-4.821,10.667-10.709C512,446.165,474.667,398.336,421.184,384.96z"/></g></g></svg>';

  itemImg.innerHTML = obj.Gender === 'male' ? svgMale : svgFemale;

  itemContainer.appendChild(itemImg);
  itemContainer.appendChild(itemFieldContainer);

  item.appendChild(itemContainer);
  resultDisplay.appendChild(item);
}

function makeItemField(fieldName,info){
  let field = document.createElement('p');
  let content = document.createTextNode(`${fieldName}: ${info}`);
  field.appendChild(content);
  field.setAttribute('class',`${fieldName} resultItem-field`);
  return field;
}

historyBtn.addEventListener('click',()=>showHistory(true));

document.body.addEventListener('click',(c)=>{
  if (c.target !== historyBtn)showHistory(false)});

function showHistory(bol){
  let list = document.getElementById('historyList');
  list.innerHTML = '';
  list.style.visibility = bol ? 'visible' : 'hidden';

  if(!bol) return

  for (search in history){
    let searchItem = document.createElement('li');
     searchItem.innerText = history[search];
    list.appendChild(searchItem);
  }
};